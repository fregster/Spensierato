		<xsl:template name="javascript">
			<script type="text/javascript">
					var document_root = '<xsl:value-of select="/page/settings/document_root" />';
					var js_host = '<xsl:value-of select="/page/settings/static_host_js" />';
					var ajax_host = '<xsl:value-of select="/page/settings/static_host_ajax" />';
					var current_page = '<xsl:value-of select="/page/@id" />';
					
					<xsl:if test="count(/page/settings/pre_load_images/setting) > 0">
					// set pre-loading image list
				       var images = new Array();
				       <xsl:for-each select="/page/settings/pre_load_images/setting">images[<xsl:value-of select="position() -1" />]="<xsl:value-of select="/page/settings/document_root" />/skin/pre-load-images/<xsl:value-of select="."/>"
				     </xsl:for-each>
					</xsl:if>
					function returnRefresh() 
					{
						window.top.document.body.innerHTML = '';
					    window.top.location = document_root+'/'+current_page;
					}
				</script>
		
			<xsl:choose>
							
				<xsl:when test="/page/user/id != 0">
				<!-- User logged in -->
					<xsl:choose>
						<xsl:when test="/page/options/admin_mode = 1">
						<!-- User logged in and in admin mode-->
							<xsl:element name="script">
								<xsl:attribute name="type">text/javascript</xsl:attribute>
								<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js" />mootools/mootools-1.2-core-yc.js,mootools/mootools-1.2-more-yc.js,public.js,logged_in.js,admin.js</xsl:attribute> //load
							</xsl:element>
						</xsl:when>
					
						<xsl:otherwise>
						<!-- User logged in and NOT in admin mode-->
							<xsl:element name="script">
								<xsl:attribute name="type">text/javascript</xsl:attribute>
								<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js" />mootools/mootools-1.2-core-yc.js,mootools/mootools-1.2-more-yc.js,public.js,logged_in.js</xsl:attribute> //load
							</xsl:element>
					</xsl:otherwise>
					</xsl:choose>
				</xsl:when>
				
				<xsl:otherwise>
				<!-- User Not logged in -->
				
					<xsl:element name="script">
						<xsl:attribute name="type">text/javascript</xsl:attribute>
						<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js" />mootools/mootools-1.2-core-yc.js,mootools/mootools-1.2-more-yc.js,public.js</xsl:attribute> //load
					</xsl:element>
				</xsl:otherwise>
				
				</xsl:choose>
		</xsl:template>