<!-- Put Scriptolucios first -->
		<xsl:template name="javascript">
				<xsl:if test="/page/user/id = 0">
				<!-- User Not logged in -->
					<xsl:element name="script">
						<xsl:attribute name="type">text/javascript</xsl:attribute>
						<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js" />public.js,prototype.js</xsl:attribute>
					</xsl:element>
					<xsl:element name="script">
						<xsl:attribute name="type">text/javascript</xsl:attribute>
						<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js_direct" />scriptaculous.js</xsl:attribute>
					</xsl:element>
				</xsl:if>
				
				<xsl:if test="/page/user/id != 0">
				<!-- User logged in -->
				
					<xsl:if test="/page/options/admin_mode = 1">
					<!-- User logged in and in admin mode-->
						<xsl:element name="script">
							<xsl:attribute name="type">text/javascript</xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js" />public.js,logged_in.js,admin.js,prototype.js,scriptaculous.js?load=effects</xsl:attribute>
						</xsl:element>
						
						<xsl:element name="script">
							<xsl:attribute name="type">text/javascript</xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js_direct" />submodal/common.js</xsl:attribute>
						</xsl:element>
						
						<xsl:element name="script">
							<xsl:attribute name="type">text/javascript</xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js_direct" />submodal/subModal.js</xsl:attribute>
						</xsl:element>
						<!-- 
						<xsl:element name="script">
							<xsl:attribute name="type">text/javascript</xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js_direct" />scriptaculous.js</xsl:attribute>
						</xsl:element>
						 -->
						<script type="text/javascript">
						function pageReload(returnVal) 
						{
                        	window.top.document.body.innerHTML = '';
							window.top.location = '<xsl:value-of select="/page/settings/document_root" />/'+returnVal;
                        }
						</script>
					</xsl:if>
				
					<xsl:if test="/page/options/admin_mode != 1">
					<!-- User logged in and NOT in admin mode-->
						<xsl:element name="script">
							<xsl:attribute name="type">text/javascript</xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js" />public.js,logged_in.js,prototype.js</xsl:attribute>
						</xsl:element>
						<xsl:element name="script">
							<xsl:attribute name="type">text/javascript</xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/site_folder_js_direct" />scriptaculous.js</xsl:attribute>
						</xsl:element>
					</xsl:if>
					
				</xsl:if>
		</xsl:template>