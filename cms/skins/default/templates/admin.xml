
		<xsl:template name="admin_bar">
			<xsl:if test="/page/user/id != 0">
				<div id="page_section_admin_bar">
					<xsl:if test="/page/security/can_edit = 1">
						<!-- can edit this page -->
						<xsl:choose>
						<xsl:when test="/page/options/admin_mode = 1">
							<!--  Show toggle admin and edit options -->
							<a href="toggle/admin_mode">Swith off Admin Mode</a><xsl:if test="/page/user/administrator =1"> | Edit Site details | Edit Site Structure</xsl:if> 			
						</xsl:when>
						<xsl:otherwise>
							<!--  Show toggle admin -->
							<a href="toggle/admin_mode">Swith on Admin Mode</a>
						</xsl:otherwise>
						</xsl:choose>
						
						<!--  If the user is a site admin show site warnings -->
						<xsl:if test="/page/user/administrator = 1">
							<xsl:if test="/page/warnings/warning">
							| <xsl:element name="img">
								<xsl:attribute name="src"><xsl:value-of select="page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
								<xsl:attribute name="class">sprite sprite-delete</xsl:attribute>
								<xsl:attribute name="alt">Icon</xsl:attribute>
							</xsl:element>
								<xsl:element name="a">
									<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/warnings</xsl:attribute>
									<xsl:attribute name="class">submodal</xsl:attribute>
									View warnings
								</xsl:element>
		
							</xsl:if>
						</xsl:if>
					</xsl:if>

					<xsl:if test="/page/security/can_edit != 1">
						<!-- can't edit -->
						<xsl:if test="/page/security/admin_mode = 1">
							 <!-- Show toggle admin out and text you can not edit -->
							 <a href="toggle/admin_mode">Swith off Admin Mode</a>
						</xsl:if>
						You can not edit this page
					</xsl:if>
</div>
			</xsl:if>
		</xsl:template>
		
		<xsl:template name="admin_edit_bar">
		<xsl:if test="/page/options/admin_mode = 1 and /page/security/can_edit =1">
			<xsl:choose>
				<xsl:when test="/page/@id != ''">
				<xsl:if test="/page/@type = 'HTML'">
					<xsl:if test="/page/security/can_approve =1">
						<xsl:element name="form">
							<xsl:attribute name="action"><xsl:value-of select="/page/settings/document_root" />/up/<xsl:value-of select="/page/@id" /></xsl:attribute>
							<xsl:attribute name="method">POST</xsl:attribute>
							<xsl:attribute name="id">update_<xsl:value-of select="/page/@id" /></xsl:attribute>
							<xsl:element name="div">	
								<xsl:attribute name="class">element_header</xsl:attribute>
								Page Title 
								<xsl:element name="input">
									<xsl:attribute name="type">text</xsl:attribute>
									<xsl:attribute name="value"><xsl:value-of select="/page/@title" /></xsl:attribute>
									<xsl:attribute name="name">title</xsl:attribute>
									<xsl:attribute name="id">title</xsl:attribute>
									<input type="Submit" value="Update" />
								</xsl:element> | 
								<xsl:element name="a">
								<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/tp/<xsl:value-of select="/page/@id" />/visibility</xsl:attribute>
									<xsl:element name="img">
										<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
										<xsl:if test="/page/@visible = 1">
											<xsl:attribute name="class">sprite sprite-lightbulb</xsl:attribute>
											<xsl:attribute name="alt">Visibile</xsl:attribute>
										</xsl:if>
										<xsl:if test="/page/@visible = 0">
											<xsl:attribute name="class">sprite sprite-lightbulb_off</xsl:attribute>
											<xsl:attribute name="alt">Hidden</xsl:attribute>
										</xsl:if>
									</xsl:element>
								</xsl:element> | 
								<xsl:element name="a">
								<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/tp/<xsl:value-of select="/page/@id" />/delete</xsl:attribute>
									<xsl:element name="img">
										<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
										<xsl:if test="/page/@deleted = 0">
											<xsl:attribute name="class">sprite sprite-cross</xsl:attribute>
											<xsl:attribute name="alt">Delete</xsl:attribute>
										</xsl:if>
										<xsl:if test="/page/@deleted != 0">
											<xsl:attribute name="class">sprite sprite-delete</xsl:attribute>
											<xsl:attribute name="alt">Marked for deletion</xsl:attribute>
										</xsl:if>
									</xsl:element>
								</xsl:element> | 
								<xsl:element name="a">
									<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/tools/page_security/<xsl:value-of select="/page/@id" /></xsl:attribute>
									<xsl:attribute name="class">submodal</xsl:attribute>
									<xsl:element name="img">
										<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
										<xsl:attribute name="class">sprite sprite-lock_edit</xsl:attribute>
										<xsl:attribute name="alt">Page Security</xsl:attribute>
									</xsl:element>
							</xsl:element>
							</xsl:element>
						</xsl:element>
						</xsl:if>
						<xsl:element name="div">
							
							<xsl:element name="form">
								<xsl:attribute name="action"><xsl:value-of select="/page/settings/document_root" />/edit/<xsl:value-of select="/page/@id" /></xsl:attribute>
								<xsl:attribute name="method">POST</xsl:attribute>
								<xsl:attribute name="id">new_<xsl:value-of select="/page/@id" /></xsl:attribute>
								<p>Create New <xsl:call-template name="new_element" /> 
								<input type="submit" value="Create" />
								</p>
							</xsl:element>
					</xsl:element>
						<br />
					</xsl:if>
			</xsl:when>
			
			<xsl:otherwise>
				<xsl:element name="form">
					<xsl:attribute name="action"><xsl:value-of select="/page/settings/document_root" />/edit/-1</xsl:attribute>
					<xsl:attribute name="method">POST</xsl:attribute>
					<div><input type="hidden" name="new_type" value="newPage" /><input type="submit" value="Create Homepage" /></div>
					
				</xsl:element>
			</xsl:otherwise>
			</xsl:choose>
		</xsl:if>
		</xsl:template>
		
		<xsl:template name="new_element">
			<select name="new_type">
			<xsl:if test="/page/security/can_approve = 1"><option value="newPage">Child Page</option></xsl:if>
				<xsl:for-each select="/page/settings/elementTypes/setting">
					<xsl:element name="option">
						<xsl:attribute name="value"><xsl:value-of select="./class" /></xsl:attribute>
						<xsl:if test="./class = 'elementText'">
							<xsl:attribute name="selected">selected</xsl:attribute>
						</xsl:if>
						<xsl:value-of select="./name" />
					</xsl:element>
				</xsl:for-each>
			</select>
		</xsl:template>
	
		<xsl:template name="element_admin_header">
		<!-- If in admin show admin header -->
		<xsl:if test="/page/security/can_edit =1">
		<xsl:if test="/page/options/admin_mode = 1">
			<xsl:element name="div">
				<xsl:attribute name="id">eid_admin_<xsl:value-of select="./@id" /></xsl:attribute>
				<xsl:attribute name="title"><xsl:value-of select="./data/title" /></xsl:attribute>
				<xsl:attribute name="class">element_header</xsl:attribute>
				
				<xsl:element name="img">
					<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
					<xsl:attribute name="class">sprite sprite-<xsl:value-of select="./@image" /></xsl:attribute>
					<xsl:attribute name="alt">Icon</xsl:attribute>
				</xsl:element>
				<xsl:value-of select="./@etype" /> | <xsl:value-of select="./data/title" />
				
				<xsl:element name="a">
					<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/edit/<xsl:value-of select="./@id" /></xsl:attribute>
					<xsl:attribute name="onclick">editContent('eid_<xsl:value-of select="./@id" />'); return false;</xsl:attribute>
					<!--<xsl:attribute name="class">submodal</xsl:attribute>  -->
					<xsl:element name="img">
						<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
						<xsl:attribute name="alt">Edit Content</xsl:attribute>
						<xsl:attribute name="class">sprite sprite-<xsl:value-of select="./@image_edit" /></xsl:attribute>
					</xsl:element>
							
				</xsl:element> | 
				 <xsl:choose>
					 <xsl:when test="/page/security/can_approve = 1">
						<xsl:element name="a">
						<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/te/<xsl:value-of select="./@id" />/visibility</xsl:attribute>
							<xsl:element name="img">
								<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
								<xsl:if test="./@visible = 1">
									<xsl:attribute name="class">sprite sprite-lightbulb</xsl:attribute>
									<xsl:attribute name="alt">Visibile</xsl:attribute>
								</xsl:if>
								<xsl:if test="./@visible != 1">
									<xsl:attribute name="class">sprite sprite-lightbulb_off</xsl:attribute>
									<xsl:attribute name="alt">Hidden</xsl:attribute>
								</xsl:if>
							</xsl:element>
						</xsl:element> | 
						<xsl:element name="a">
						<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/te/<xsl:value-of select="./@id" />/delete</xsl:attribute>
							<xsl:element name="img">
								<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
								<xsl:if test="./@deleted = 0">
									<xsl:attribute name="class">sprite sprite-cross</xsl:attribute>
									<xsl:attribute name="alt">Delete</xsl:attribute>
								</xsl:if>
								<xsl:if test="./@deleted != 0">
									<xsl:attribute name="class">sprite sprite-delete</xsl:attribute>
									<xsl:attribute name="alt">Marked for deletion</xsl:attribute>
								</xsl:if>
							</xsl:element>
						</xsl:element>
						<xsl:if test="./@new_v_available > 0"> New version awaiting approval 
						<xsl:element name="a">
						<xsl:attribute name="href"><xsl:value-of select="/page/settings/document_root" />/te/<xsl:value-of select="./@id" />/quickapprove</xsl:attribute>
							<xsl:element name="img">
								<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
								<xsl:attribute name="class">sprite sprite-accept</xsl:attribute>
								<xsl:attribute name="alt">Quick Approve</xsl:attribute>
							</xsl:element>
						</xsl:element>
						</xsl:if>
					</xsl:when>

					<xsl:otherwise>
						<xsl:element name="img">
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
							<xsl:if test="./@visible = 1">
								<xsl:attribute name="class">sprite sprite-lightbulb</xsl:attribute>
								<xsl:attribute name="alt">Visibile</xsl:attribute>
							</xsl:if>
							<xsl:if test="./@visible != 1">
								<xsl:attribute name="class">sprite sprite-lightbulb_off</xsl:attribute>
								<xsl:attribute name="alt">Hidden</xsl:attribute>
							</xsl:if>
						</xsl:element> | 
						<xsl:element name="img">
							<xsl:attribute name="src"><xsl:value-of select="/page/settings/document_root" />/skin/transparent-gif.gif</xsl:attribute>
							<xsl:if test="./@deleted = 0">
								<xsl:attribute name="class">sprite sprite-cross</xsl:attribute>
								<xsl:attribute name="alt">Delete</xsl:attribute>
							</xsl:if>
							<xsl:if test="./@deleted != 0">
								<xsl:attribute name="class">sprite sprite-delete</xsl:attribute>
								<xsl:attribute name="alt">Marked for deletion</xsl:attribute>
							</xsl:if>
						</xsl:element>
						<xsl:if test="./@new_v_available > 0"> New version awaiting approval </xsl:if>
					</xsl:otherwise>
					<xsl:if test="./@draft_available > 0"> You have a draft update saved </xsl:if>
				</xsl:choose>
			</xsl:element>			
		</xsl:if>
		</xsl:if>
	</xsl:template>
	
	<xsl:template name="element_admin_footer">
		<!-- If in admin show admin header -->
		<xsl:if test="/page/options/admin_mode = 1">
			<xsl:element name="div">
				<xsl:attribute name="class">element_footer</xsl:attribute>
				Admin Element Footer
			</xsl:element>
			<br />
		</xsl:if>		
	</xsl:template>